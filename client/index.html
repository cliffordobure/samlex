<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Samlex - Law Firm SaaS</title>
    <style>
      /* Loading fallback */
      #root:empty::before {
        content: "Loading...";
        display: block;
        padding: 20px;
        text-align: center;
        color: #666;
      }
      /* Error fallback */
      .error-fallback {
        padding: 20px;
        background: #fee;
        color: #c33;
        border: 1px solid #c33;
        margin: 20px;
        border-radius: 4px;
      }
    </style>
  </head>
  <body>
    <div id="root">
      <div style="padding: 20px; text-align: center;">
        <h1>Loading Application...</h1>
        <p>If this message persists, check the browser console for errors.</p>
      </div>
    </div>
    <script>
      // Capture ALL errors immediately
      const errors = [];
      const originalConsoleError = console.error;
      console.error = function() {
        errors.push(Array.from(arguments));
        originalConsoleError.apply(console, arguments);
      };
      
      // Immediate error logging - CAPTURE PHASE to catch module errors
      window.addEventListener('error', function(e) {
        console.error('‚ùå‚ùå‚ùå ERROR EVENT CAUGHT ‚ùå‚ùå‚ùå');
        console.error('Global error:', e.error);
        console.error('Error details:', {
          message: e.message,
          filename: e.filename,
          lineno: e.lineno,
          colno: e.colno,
          error: e.error,
          stack: e.error ? e.error.stack : 'No stack'
        });
        
        // Show error immediately
        const root = document.getElementById('root');
        if (root) {
          const errorHtml = '<div class="error-fallback" style="padding: 20px; background: #fee; border: 2px solid #c33; margin: 20px; border-radius: 4px; color: #c33;"><h2>‚ùå JavaScript Error Detected</h2><p><strong>Error Message:</strong> ' + e.message + '</p><p><strong>File:</strong> ' + (e.filename || 'unknown') + '</p><p><strong>Line:</strong> ' + (e.lineno || 'unknown') + '</p><pre style="background: #fff; padding: 10px; overflow: auto; white-space: pre-wrap;">' + (e.error ? e.error.stack : 'No stack trace available') + '</pre><p><small>Check browser console (F12) for more details</small></p></div>';
          root.innerHTML = errorHtml;
        }
      }, true); // Use capture phase
      
      // Log script loading errors
      window.addEventListener('error', function(e) {
        console.error('‚ùå ERROR EVENT CAUGHT:', {
          message: e.message,
          filename: e.filename,
          lineno: e.lineno,
          colno: e.colno,
          error: e.error,
          target: e.target
        });
        
        if (e.target && e.target.tagName === 'SCRIPT') {
          console.error('‚ùå Script loading error:', {
            src: e.target.src,
            error: e.message,
            filename: e.filename,
            lineno: e.lineno
          });
          const root = document.getElementById('root');
          if (root) {
            root.innerHTML = '<div class="error-fallback"><h2>Script Loading Error</h2><p>Failed to load: ' + e.target.src + '</p><p>Error: ' + e.message + '</p><p>File: ' + (e.filename || 'unknown') + '</p><p>Line: ' + (e.lineno || 'unknown') + '</p><p>Check Network tab for details.</p></div>';
          }
        } else {
          // Any other error
          console.error('‚ùå Runtime error:', e.message);
          const root = document.getElementById('root');
          if (root && root.innerHTML.includes('Loading')) {
            root.innerHTML = '<div class="error-fallback"><h2>JavaScript Error</h2><p><strong>Error:</strong> ' + e.message + '</p><p><strong>File:</strong> ' + (e.filename || 'unknown') + '</p><p><strong>Line:</strong> ' + (e.lineno || 'unknown') + '</p><pre style="background: #fff; padding: 10px; overflow: auto;">' + (e.error ? e.error.stack : 'No stack trace') + '</pre></div>';
          }
        }
      }, true);
      
      // Log when page loads
      console.log('HTML loaded, attempting to load main.jsx...');
      console.log('Current URL:', window.location.href);
      console.log('User Agent:', navigator.userAgent);
      
      // Check if script loads after a timeout
      setTimeout(function() {
        if (!window.__APP_LOADED__) {
          console.error('‚ö†Ô∏è App did not load within 5 seconds');
          console.log('Checking for script errors...');
          const scripts = document.querySelectorAll('script[type="module"]');
          console.log('Found', scripts.length, 'module scripts');
          scripts.forEach(function(script, index) {
            console.log('Script', index + ':', script.src || 'inline');
            if (script.src) {
              // Try to fetch the script to see if it exists
              fetch(script.src)
                .then(function(response) {
                  console.log('Script', script.src, 'status:', response.status);
                  if (!response.ok) {
                    console.error('‚ùå Script file not found or error:', response.status, response.statusText);
                    const root = document.getElementById('root');
                    if (root) {
                      root.innerHTML = '<div class="error-fallback"><h2>Script Not Found</h2><p>Failed to load: ' + script.src + '</p><p>Status: ' + response.status + ' ' + response.statusText + '</p><p>This usually means the build did not complete correctly or the file path is wrong.</p><p>Check Vercel build logs for errors.</p></div>';
                    }
                  } else {
                    console.log('‚úÖ Script file exists and is accessible');
                    // Try to read the script content to check if it's valid
                    response.text().then(function(scriptContent) {
                      console.log('üìÑ Script file size:', scriptContent.length, 'characters');
                      // Check if it looks like valid JavaScript
                      if (scriptContent.includes('import') || scriptContent.includes('export') || scriptContent.includes('function')) {
                        console.log('‚úÖ Script appears to contain valid JavaScript');
                      } else {
                        console.error('‚ö†Ô∏è Script content might be invalid or empty');
                        console.log('First 200 characters:', scriptContent.substring(0, 200));
                      }
                      
                      // Check if main.jsx executed
                      if (!window.__APP_LOADING__ && !window.__APP_LOADED__) {
                        console.error('‚ùå Script loaded but main.jsx did not execute!');
                        console.error('This means there is a JavaScript error preventing execution.');
                        console.error('The script file loaded successfully but the code inside failed to run.');
                        console.error('This is usually caused by:');
                        console.error('1. Syntax error in the bundled code');
                        console.error('2. Import/module resolution error');
                        console.error('3. Runtime error during module initialization');
                        console.error('Check Console tab above for red error messages with file names and line numbers.');
                      }
                    }).catch(function(err) {
                      console.error('Error reading script content:', err);
                    });
                  }
                })
                .catch(function(error) {
                  console.error('‚ùå Error checking script:', error);
                });
            }
          });
          
          // Check for console errors
          const originalError = console.error;
          let errorCount = 0;
          console.error = function() {
            errorCount++;
            originalError.apply(console, arguments);
          };
          
          // Show diagnostic message with collected errors
          const root = document.getElementById('root');
          if (root && !root.innerHTML.includes('error-fallback')) {
            let errorSummary = '';
            if (errors.length > 0) {
              errorSummary = '<div style="background: #fee; padding: 10px; margin: 10px 0; border-radius: 4px;"><strong>Errors captured:</strong><ul>';
              errors.forEach(function(err, idx) {
                errorSummary += '<li>' + JSON.stringify(err) + '</li>';
              });
              errorSummary += '</ul></div>';
            }
            
            root.innerHTML = '<div style="padding: 20px; text-align: center; background: #fff3cd; border: 2px solid #ffc107; margin: 20px; border-radius: 4px;"><h2>‚ö†Ô∏è Application Not Loading</h2><p>The script file loaded successfully (status 200) but the JavaScript code inside is NOT executing.</p><p><strong>This means there is a JavaScript error preventing the code from running.</strong></p>' + errorSummary + '<p><strong>What to check:</strong></p><ol style="text-align: left; display: inline-block;"><li>Look in the <strong>Console tab</strong> for red error messages</li><li>Check if you see "üöÄ main.jsx script started" - if NOT, the script failed before first line</li><li>Look for errors with file names like "index-D1ymCBAx.js"</li><li>Check Vercel build logs for build errors</li></ol><p><small>Scroll up in the Console tab to see the actual error message</small></p></div>';
          }
        }
      }, 5000);
    </script>
    <script type="module" src="/src/main.jsx"></script>
    <noscript>
      <div style="padding: 20px; text-align: center; background: #fee; color: #c33;">
        <h1>JavaScript is Required</h1>
        <p>Please enable JavaScript to use this application.</p>
      </div>
    </noscript>
  </body>
</html>
